import{r as s,u as C,b as T,m as L,j as e,e as o,g as R,f as h,t as u,n as E,T as f,o as I}from"./index-CJhXJ4pT.js";const B=l=>s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...l},s.createElement("rect",{width:24,height:24,fill:"none"}),s.createElement("path",{fill:"#000",d:"m12.11 15.39l-3.88 3.88a2.52 2.52 0 0 1-3.5 0a2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 1 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 0 0-1.42-1.42m8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 1 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0a2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 0 0 0 1.42a1 1 0 0 0 1.42 0l3.88-3.89a4.49 4.49 0 0 0 0-6.33M8.83 15.17a1 1 0 0 0 .71.29a1 1 0 0 0 .71-.29l4.92-4.92a1 1 0 1 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42"}));function F(){const{server:l}=C(),{t:r}=T(),[d,x]=s.useState(!1),m=async()=>{const a=await I(l+"referral");return{count:Number(a.total_referrals)||0,earn:Number(a.stars_earned)||0,balance:Number(a.available_balance)||0,link:a.link||""}},{data:t}=L({queryKey:["referral"],queryFn:m,staleTime:f,cacheTime:f}),[p,b]=s.useState(null),[j,g]=s.useState(null),[y,v]=s.useState(null),[i,N]=s.useState("");s.useEffect(()=>{if(!t)return;const a=n=>{if(n==null)return 0;const c=n.toFixed(1);return c.endsWith(".0")?c.slice(0,-2):c};b(Number(t.count??0)),g(a(t.earn??0)),v(a(t.balance??0)),N(t.link??"")},[t]);const w=()=>{if(i){const a=r("referral.shareMessage"),n=`https://t.me/share/url?url=${encodeURIComponent(i)}&text=${encodeURIComponent(a)}`;u.openTelegramLink&&u.openTelegramLink(n)}},k=async()=>{if(d)return;const a=i;try{await navigator.clipboard.writeText(a),x(!0)}catch(n){console.error("Failed to copy text: ",n)}},S=async()=>{const a=await E(l+"referral/claim");console.log(a)};return e.jsxs("div",{id:"referral",className:"app-page",children:[e.jsxs("div",{id:"referral-title",className:"box",children:[e.jsx("span",{className:"header-text",children:r("header.referralsystem")}),e.jsx("span",{className:"secondary-text",children:r("definition.referral")})]}),e.jsxs("div",{id:"referral-buttons",className:"box",children:[e.jsx("button",{className:"button-main",onClick:w,children:e.jsx("span",{children:r("button.invite")})}),e.jsxs("button",{className:"button-secondary",onClick:k,children:[e.jsx(B,{className:"icon-default",width:16,height:16}),e.jsx("span",{children:r(d?"button.linkcopied":"button.copylink")})]})]}),e.jsxs("div",{id:"referral-info",children:[e.jsxs("div",{id:"referral-number",className:"box",children:[e.jsx("span",{className:"secondary-text",children:r("header.referrals")}),e.jsx(o,{value:p,icon:e.jsx(R,{className:"icon-default",width:18,height:18}),filled:!1})]}),e.jsxs("div",{id:"referral-earn",className:"box",children:[e.jsx("span",{className:"secondary-text",children:r("header.referralearn")}),e.jsx(o,{value:j,icon:e.jsx(h,{width:18,height:18}),filled:!0})]})]}),e.jsxs("div",{id:"referral-balance",className:"box",children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[e.jsx("span",{className:"secondary-text",children:r("header.referralbalance")}),e.jsx(o,{value:y,icon:e.jsx(h,{width:18,height:18}),filled:!0})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:5},children:e.jsx("button",{className:"button-main",onClick:S,children:e.jsx("span",{children:r("button.withdraw")})})})]})]})}export{F as default};
