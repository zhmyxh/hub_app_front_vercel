import{r as t,d as g,u as w,b as v,j as e,P as y,S as d,h as N,g as k}from"./index-B9GGO-S0.js";const S=a=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...a},t.createElement("rect",{width:24,height:24,fill:"none"}),t.createElement("path",{fill:"#000",d:"m12.11 15.39l-3.88 3.88a2.52 2.52 0 0 1-3.5 0a2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 1 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 0 0-1.42-1.42m8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 1 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0a2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 0 0 0 1.42a1 1 0 0 0 1.42 0l3.88-3.89a4.49 4.49 0 0 0 0-6.33M8.83 15.17a1 1 0 0 0 .71.29a1 1 0 0 0 .71-.29l4.92-4.92a1 1 0 1 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42"})),E=a=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...a},t.createElement("rect",{width:24,height:24,fill:"none"}),t.createElement("path",{fill:"#000",d:"M15.5 7.5a3.5 3.5 0 1 1-7 0a3.5 3.5 0 0 1 7 0m2.5 9c0 1.933-2.686 3.5-6 3.5s-6-1.567-6-3.5S8.686 13 12 13s6 1.567 6 3.5M7.122 5q.267 0 .518.05A5 5 0 0 0 7 7.5c0 .868.221 1.685.61 2.396q-.237.045-.488.045c-1.414 0-2.561-1.106-2.561-2.47S5.708 5 7.122 5M5.447 18.986C4.88 18.307 4.5 17.474 4.5 16.5c0-.944.357-1.756.896-2.423C3.49 14.225 2 15.267 2 16.529c0 1.275 1.517 2.325 3.447 2.457M17 7.5c0 .868-.221 1.685-.61 2.396q.236.045.488.045c1.414 0 2.56-1.106 2.56-2.47S18.293 5 16.879 5q-.267 0-.518.05c.407.724.64 1.56.64 2.45m1.552 11.486c1.93-.132 3.447-1.182 3.447-2.457c0-1.263-1.491-2.304-3.396-2.452c.54.667.896 1.479.896 2.423c0 .974-.38 1.807-.947 2.486"}));function M(){const{referral:a,setReferral:h,referralUpdatedAt:l,balance:C,user:L}=g(),{server:c}=w(),{t:s}=v(),[i,x]=t.useState(!1),[f,m]=t.useState(!a),u=60*1e3;t.useEffect(()=>{const r=!l||Date.now()-l>u;if(a&&!r)return;(async()=>{try{const n=await N(c+"referral");h({count:Number(n.total_referrals)||0,earn:Number(n.stars_earned)||0,balance:Number(n.available_balance)||0,link:n.link||""})}finally{m(!1)}})()},[a]);const p=()=>{console.log("link shared")},b=async()=>{if(i)return;const r=a.link;try{await navigator.clipboard.writeText(r),x(!0)}catch(o){console.error("Failed to copy text: ",o)}},j=async()=>{const r=await k(c+"referral/claim");console.log(r)};return f?e.jsx(y,{}):e.jsxs("div",{id:"referral",className:"app-page",children:[e.jsxs("div",{id:"referral-title",className:"box",children:[e.jsx("span",{className:"header-text",children:s("header.referralsystem")}),e.jsx("span",{className:"secondary-text",children:s("definition.referral")})]}),e.jsxs("div",{id:"referral-buttons",className:"box",children:[e.jsx("button",{className:"button-main",onClick:p,children:e.jsx("span",{children:s("button.invite")})}),e.jsxs("button",{className:"button-secondary",onClick:b,children:[e.jsx(S,{className:"icon-default",width:16,height:16}),e.jsx("span",{children:s(i?"button.linkcopied":"button.copylink")})]})]}),e.jsxs("div",{id:"referral-info",children:[e.jsxs("div",{id:"referral-number",className:"box",children:[e.jsx("span",{className:"secondary-text",children:s("header.referrals")}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5},children:[e.jsx(E,{className:"icon-default",width:20,height:20}),e.jsx("span",{className:"header-text",style:{fontWeight:500},children:a.count})]})]}),e.jsxs("div",{id:"referral-earn",className:"box",children:[e.jsx("span",{className:"secondary-text",children:s("header.referralearn")}),e.jsx(d,{value:a.earn?.toFixed(1)})]})]}),e.jsxs("div",{id:"referral-balance",className:"box",children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[e.jsx("span",{className:"secondary-text",children:s("header.referralbalance")}),e.jsx(d,{value:a.balance?.toFixed(1)})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:5},children:e.jsx("button",{className:"button-main",onClick:j,children:e.jsx("span",{children:s("button.withdraw")})})})]})]})}export{M as default};
